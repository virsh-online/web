
        <?php if ($this('error')): ?>
            <div class="alert alert-error">
                <?= htmlspecialchars($this('error')) ?>
            </div>
        <?php endif; ?>
        
        <?php if ($this('success')): ?>
            <div class="alert alert-success">
                <?= htmlspecialchars($this('success')) ?>
            </div>
        <?php endif; ?>
        
        <div class="form-container">
            <form method="POST" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="title">Назва вірша: *</label>
                    <input type="text" 
                           id="title" 
                           name="title" 
                           value="<?= htmlspecialchars($this('poem')->get('title') ?? '') ?>" 
                           required>
                </div>
                
                <div class="form-group">
                    <label for="virsh">Текст вірша: *</label>
                    <div id="virsh-editor" style="background: white; min-height: 200px;"></div>
                    <textarea id="virsh" 
                              name="virsh" 
                              style="display: none;" 
                              required><?= htmlspecialchars($this('poem')->get('virsh') ?? '') ?></textarea>
                </div>
                
                <div class="form-group">
                    <label for="youtube">YouTube посилання:</label>
                    <input type="text" 
                           id="youtube" 
                           name="youtube" 
                           value="<?= htmlspecialchars($this('poem')->get('youtube') ?? '') ?>"
                           placeholder="VIDEO ID">
                    <small style="color: #666; display: block; margin-top: 0.25rem;">
                        Формат: VIDEO_ID
                    </small>
                </div>
                
                <div class="form-group">
                    <label for="illustration">Ілюстрація:</label>
                    <?php if ($this('poem')->get('illustration')): ?>
                        <div class="current-illustration">
                            <img src="<?= htmlspecialchars($this('poem')->getIllustrationUrl()) ?>" 
                                 alt="Поточна ілюстрація">
                            <p>Поточна ілюстрація (буде замінена при завантаженні нової)</p>
                            <label style="margin-top: 0.5rem;">
                                <input type="checkbox" 
                                       name="remove_illustration" 
                                       value="1">
                                Видалити ілюстрацію
                            </label>
                        </div>
                    <?php endif; ?>
                    <input type="file" 
                           id="illustration" 
                           name="illustration[]" 
                           accept="image/jpeg,image/png,image/gif,image/webp">
                    <small style="color: #666; display: block; margin-top: 0.25rem;">
                        Підтримуються формати: JPG, PNG, GIF, WEBP (макс. 5MB)
                    </small>
                </div>
                
                <?php if ($this('poem')->get('illustration')): ?>
                <div class="form-group">
                    <label>
                        <input type="checkbox" 
                               name="illustration_enabled" 
                               value="1" 
                               <?= ($this('poem')->get('illustration_enabled') ?? 1) ? 'checked' : '' ?>>
                        Показувати ілюстрацію на сайті
                    </label>
                </div>
                <?php endif; ?>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" 
                               name="enabled" 
                               value="1" 
                               <?= ($this('poem')->get('enabled') ?? 1) ? 'checked' : '' ?>>
                        Опублікувати на сайті
                    </label>
                </div>
                
                <div class="form-actions">
                    <button type="submit" title="Зберегти">✓</button>
                    <a href="/admin/index" class="btn-cancel" title="Скасувати">←</a>
                </div>
            </form>
        </div>

        <!-- Quill.js Rich Text Editor -->
        <link href="https://unpkg.com/quill@1.3.7/dist/quill.snow.css" rel="stylesheet">
        <script src="https://unpkg.com/quill@1.3.7/dist/quill.min.js"></script>
        <script>
        document.addEventListener('DOMContentLoaded', function() {
            const textarea = document.getElementById('virsh');
            const editorContainer = document.getElementById('virsh-editor');
            const form = editorContainer.closest('form');

            // Initialize Quill editor with basic formatting options
            const quill = new Quill('#virsh-editor', {
                theme: 'snow',
                modules: {
                    toolbar: [
                        ['bold', 'italic'],
                        [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                        ['clean']
                    ]
                },
                placeholder: 'Введіть текст вірша...'
            });

            // Load existing content from textarea
            if (textarea.value) {
                quill.root.innerHTML = textarea.value;
            }

            // Sync Quill content to textarea before form submission
            form.addEventListener('submit', function() {
                textarea.value = quill.root.innerHTML;
            });
        });
        </script>
