
        <?php if ($this('error')): ?>
            <div class="alert alert-error">
                <?php if ($this('error') === 'delete_failed'): ?>
                    Не вдалося видалити вірш
                <?php elseif ($this('error') === 'toggle_failed'): ?>
                    Не вдалося змінити статус вірша
                <?php else: ?>
                    Сталася помилка
                <?php endif; ?>
            </div>
        <?php endif; ?>
        
        <a href="/admin/poetry/edit" class="btn-primary" title="Додати новий вірш">+</a>
        
        <div class="cards-container">
            <?php 
            /** @var \App\Model\Virsh $poem */
            foreach ($this('collection') as $poem): ?>
                <div class="poem-card <?= $poem('enabled') ? '' : 'disabled' ?>">
                    <h3><?= htmlspecialchars($poem('title')) ?></h3>
                    
                    <?php if ($poem->getIllustrationUrl()): ?>
                        <div class="poem-illustration">
                            <img src="<?= htmlspecialchars($poem->getIllustrationUrl()) ?>" 
                                 alt="<?= htmlspecialchars($poem('title')) ?>">
                        </div>
                    <?php endif; ?>
                    
                    <div class="poem-excerpt">
                        <?php 
                        $excerpt = mb_substr($poem('virsh'), 0, 150);
                        echo htmlspecialchars($excerpt);
                        if (mb_strlen($poem('virsh')) > 150) {
                            echo '...';
                        }
                        ?>
                    </div>
                    
                    <div class="poem-actions">
                        <a href="/admin/poetry/edit&id=<?= $poem('id') ?>" class="btn btn-edit" title="Редагувати">
                            ✎
                        </a>
                        <a href="/admin/poetry/toggle&id=<?= $poem('id') ?>" 
                           class="btn btn-toggle <?= $poem('enabled') ? 'enabled' : '' ?>"
                           title="<?= $poem('enabled') ? 'Вимкнути' : 'Увімкнути' ?>"
                           onclick="return confirm('Ви впевнені?')">
                            <?= $poem('enabled') ? '●' : '○' ?>
                        </a>
                        <a href="/admin/poetry/delete&id=<?= $poem('id') ?>" 
                           class="btn btn-delete"
                           title="Видалити"
                           onclick="return confirm('Ви впевнені, що хочете видалити цей вірш?')">
                            ×
                        </a>
                    </div>
                </div>
            <?php endforeach; ?>
        </div>

        <?php if ($this('totalPages') > 1): ?>
        <div class="pagination">
            <?php
            $currentPage = $this('currentPage');
            $totalPages = $this('totalPages');
            $delta = 2; // Number of pages to show on each side of current page
            
            // Previous button
            if ($currentPage > 1): ?>
                <a href="/admin/index?page=<?= $currentPage - 1 ?>" class="pagination-btn pagination-prev" title="Попередня сторінка" aria-label="Попередня сторінка">←</a>
            <?php endif; ?>
            
            <div class="pagination-pages">
                <?php
                // Always show first page
                if ($currentPage > $delta + 2): ?>
                    <a href="/admin/index?page=1" class="pagination-page">1</a>
                    <?php if ($currentPage > $delta + 3): ?>
                        <span class="pagination-ellipsis">...</span>
                    <?php endif; ?>
                <?php endif;
                
                // Show pages around current page
                for ($i = max(1, $currentPage - $delta); $i <= min($totalPages, $currentPage + $delta); $i++): ?>
                    <?php if ($i == $currentPage): ?>
                        <span class="pagination-page pagination-current"><?= $i ?></span>
                    <?php else: ?>
                        <a href="/admin/index?page=<?= $i ?>" class="pagination-page"><?= $i ?></a>
                    <?php endif; ?>
                <?php endfor;
                
                // Always show last page
                if ($currentPage < $totalPages - $delta - 1): ?>
                    <?php if ($currentPage < $totalPages - $delta - 2): ?>
                        <span class="pagination-ellipsis">...</span>
                    <?php endif; ?>
                    <a href="/admin/index?page=<?= $totalPages ?>" class="pagination-page"><?= $totalPages ?></a>
                <?php endif; ?>
            </div>
            
            <?php
            // Next button
            if ($currentPage < $totalPages): ?>
                <a href="/admin/index?page=<?= $currentPage + 1 ?>" class="pagination-btn pagination-next" title="Наступна сторінка" aria-label="Наступна сторінка">→</a>
            <?php endif; ?>
            
            <!-- Direct page input -->
            <div class="pagination-goto">
                <form method="get" action="/admin/index" class="pagination-goto-form">
                    <label for="page-input" class="pagination-goto-label">Перейти:</label>
                    <input type="number" 
                           id="page-input" 
                           name="page" 
                           min="1" 
                           max="<?= $totalPages ?>" 
                           value="<?= $currentPage ?>"
                           class="pagination-goto-input"
                           title="Введіть номер сторінки">
                    <button type="submit" class="pagination-goto-btn" title="Перейти до сторінки" aria-label="Перейти до сторінки">→</button>
                </form>
            </div>
            
            <span class="pagination-info">
                Сторінка <?= $currentPage ?> з <?= $totalPages ?> (всього: <?= $this('totalCount') ?>)
            </span>
        </div>
        <?php endif; ?>
