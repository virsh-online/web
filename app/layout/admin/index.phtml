<div class="admin-header">
    <button class="burger-menu">‚ò∞</button>
    <h1>–ê–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—å - –ü–æ—î–∑—ñ—è</h1>
</div>

<div class="overlay"></div>

<div class="admin-container">
    <aside class="admin-sidebar">
        <nav>
            <a href="/?q=admin/index" class="active">üìù –ü–æ—î–∑—ñ—è</a>
            <a href="/?q=admin/logout">üö™ –í–∏—Ö—ñ–¥</a>
        </nav>
    </aside>
    
    <main class="admin-main">
        <?php if ($this('error')): ?>
            <div class="alert alert-error">
                <?php if ($this('error') === 'delete_failed'): ?>
                    –ù–µ –≤–¥–∞–ª–æ—Å—è –≤–∏–¥–∞–ª–∏—Ç–∏ –≤—ñ—Ä—à
                <?php elseif ($this('error') === 'toggle_failed'): ?>
                    –ù–µ –≤–¥–∞–ª–æ—Å—è –∑–º—ñ–Ω–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å –≤—ñ—Ä—à–∞
                <?php else: ?>
                    –°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞
                <?php endif; ?>
            </div>
        <?php endif; ?>
        
        <a href="/?q=admin/edit" class="btn-primary">+ –î–æ–¥–∞—Ç–∏ –Ω–æ–≤–∏–π –≤—ñ—Ä—à</a>
        
        <div class="cards-container">
            <?php foreach ($this('collection') as $poem): ?>
                <div class="poem-card <?= $poem('enabled') ? '' : 'disabled' ?>">
                    <h3><?= htmlspecialchars($poem('title')) ?></h3>
                    <div class="poem-excerpt">
                        <?php 
                        $excerpt = mb_substr($poem('virsh'), 0, 150);
                        echo htmlspecialchars($excerpt);
                        if (mb_strlen($poem('virsh')) > 150) {
                            echo '...';
                        }
                        ?>
                    </div>
                    
                    <?php if ($poem('illustration')): ?>
                        <div style="margin: 1rem 0;">
                            <img src="/<?= htmlspecialchars($poem('illustration')) ?>" 
                                 alt="<?= htmlspecialchars($poem('title')) ?>" 
                                 style="max-width: 100%; height: auto; border-radius: 4px;">
                        </div>
                    <?php endif; ?>
                    
                    <div class="poem-actions">
                        <a href="/?q=admin/edit&id=<?= $poem('id') ?>" class="btn btn-edit">
                            ‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞—Ç–∏
                        </a>
                        <a href="/?q=admin/toggle&id=<?= $poem('id') ?>" 
                           class="btn btn-toggle <?= $poem('enabled') ? 'enabled' : '' ?>"
                           onclick="return confirm('–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ?')">
                            <?= $poem('enabled') ? 'üëÅÔ∏è –í–∏–º–∫–Ω—É—Ç–∏' : 'üëÅÔ∏è‚Äçüó®Ô∏è –£–≤—ñ–º–∫–Ω—É—Ç–∏' ?>
                        </a>
                        <a href="/?q=admin/delete&id=<?= $poem('id') ?>" 
                           class="btn btn-delete"
                           onclick="return confirm('–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü–µ–π –≤—ñ—Ä—à?')">
                            üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏
                        </a>
                    </div>
                </div>
            <?php endforeach; ?>
        </div>
        
        <?php if (count($this('collection')) === 0): ?>
            <div style="text-align: center; padding: 3rem; color: #666;">
                <p style="font-size: 1.2rem;">–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î –≤—ñ—Ä—à—ñ–≤</p>
                <p>–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "–î–æ–¥–∞—Ç–∏ –Ω–æ–≤–∏–π –≤—ñ—Ä—à" —â–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø–µ—Ä—à–∏–π</p>
            </div>
        <?php endif; ?>
    </main>
</div>
